<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>AR.js Example</title>
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <!-- include ar.js for A-Frame -->
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <style>
        body,
        html {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden;
        }
    </style>
</head>
<body>
<a-scene
        embedded
        arjs="trackingMethod: best; sourceType: webcam; debugUIEnabled: false;"
>

    <a-marker-camera preset='custom' type='pattern' url='tags/patt/20.patt'>
        <!--        <a-cylinder position="0 0.5 0" material="color: blue;"></a-cylinder>-->
        <!--        <a-text scale="2 2 2" value="Hello world" position="0 1 0" rotation="-90 0 0" material="color: blue;"></a-text>-->
<!--        <a-entity scale="0.1 0.1 0.1" obj-model="obj: url(OBJ/map.obj)"></a-entity>-->
    </a-marker-camera>
    <a-entity camera></a-entity>
</a-scene>
</body>
<script type="module">

    const RECEPTION_LOCATION = {x: -1.5, y: 0.1, z: 2};
    const PIP_ROTATION = {x: -Math.PI / 2, y: 0, z: 0};

    var textureLoader = new THREE.TextureLoader();
    textureLoader.load('FLOOR_G.png', function(texture) {
        var geometry = new THREE.PlaneGeometry(10, 5); // Размеры плоскости можно корректировать
        var material = new THREE.MeshBasicMaterial({ map: texture, side: THREE.DoubleSide });
        var plane = new THREE.Mesh(geometry, material);

        plane.position.set(0, 0, 0);
        plane.scale.set(2.5, 2.5, 2.5);
        plane.rotation.x = -Math.PI / 2;

        var mtlLoader = new THREE.MTLLoader();
        mtlLoader.load('OBJ/Pip_stand.mtl', function (materials) {
            materials.preload();

            var objLoader = new THREE.OBJLoader();
            objLoader.setMaterials(materials);
            objLoader.load('OBJ/Pip_stand.obj', function (object) {
                object.scale.set(0.1, 0.1, 0.1);
                object.rotation.set(PIP_ROTATION.x, PIP_ROTATION.y, PIP_ROTATION.z);
                object.position.set(RECEPTION_LOCATION.x, RECEPTION_LOCATION.y, RECEPTION_LOCATION.z);

                var marker = document.querySelector('a-marker-camera');
                if (marker) {
                    marker.object3D.add(plane);
                    marker.object3D.add(object);
                    console.log('3D Object with materials loaded onto marker.');
                } else {
                    console.log('No marker found.');
                }
            })
        })
    });
</script>
</html>